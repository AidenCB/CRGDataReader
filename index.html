<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DataReader Web</title>

    <!-- Load PyScript -->
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
</head>
<body>

    <h1>Upload a CSV File</h1>

    <!-- File input -->
    <input type="file" id="fileInput" />

    <button py-click="process_file()">Run DataReader</button>

    <h2>Output</h2>
    <pre id="output"></pre>

    <!-- Python environment -->
    <py-config>
        packages = ["pandas"]
    </py-config>

<script type="py-script">
    import pandas as pd
    from js import document

    def process_file():
        out = Element("output")
        fileInput = document.getElementById("fileInput")

        if fileInput.files.length == 0:
            out.write("Please upload a file first.")
            return

        # Get uploaded file
        file = fileInput.files.item(0)
        text = await file.text()   # read file as text in browser

        try:
            df = pd.read_csv(pd.compat.StringIO(text))
            out.write("File loaded successfully!\n")
            out.write(str(df.head()))
        except Exception as e:
            out.write(f"Error reading file: {e}")
    </script>

</body>
</html>

